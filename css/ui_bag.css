/* css/ui_bag.css */

/* === 1. 弹窗容器控制 === */
.modal_bag {
    padding: 0 !important;
    background-color: #fdfdfd;
}

/* === 2. 背包整体布局 === */
.bag_container {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    font-family: "Kaiti", "STKaiti", "SimSun", serif;
}

/* === 3. 顶部装备栏 (优化版) === */
.bag_equipment_row {
    display: flex;
    justify-content: center;
    align-items: flex-start; /* 【新增】让装备格顶部对齐 */
    gap: 20px;
    padding: 12px 25px;
    margin: 10px auto 5px auto;
    width: fit-content;
    min-width: 50%;
    max-width: 95%;
    background: #fcfcfc;
    border: 1px solid #ddd;
    border-radius: 50px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    flex-shrink: 0;
    flex-wrap: wrap;
}

.bag_equip_wrapper {
    display: flex;
    align-items: center;
    flex-direction: column;
    gap: 4px;
    cursor: pointer; /* 增加手型 */
}

.bag_equip_label {
    font-size: 15px; /* 稍微加大一点 */
    color: #666;
}

.bag_equip_slot {
    width: 50px;
    height: 50px;
    border: 2px dashed #ccc; /* 默认虚线 */
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #fff;
    transition: all 0.2s;
    position: relative;
}

.bag_equip_slot.active {
    border-style: solid; /* 有装备时实线 */
    background: #fffbf0; /* 微微泛黄 */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.bag_equip_icon {
    font-size: 30px; /* 图标加大 */
    line-height: 1;
}

/* === 4. 工具栏 === */
.bag_toolbar {
    display: flex;
    justify-content: flex-end;
    padding: 5px 20px;
    background: #f5f5f5;
    border-bottom: 1px solid #ddd;
    gap: 10px;
    flex-shrink: 0;
    align-items: center;
    height: 45px;
}

.bag_btn_action {
    padding: 6px 12px;
    border: 1px solid #ccc;
    background: #fff;
    color: #333;
    cursor: pointer;
    font-size: 18px;
    border-radius: 4px;
    transition: all 0.2s;
    font-family: inherit;
}
.bag_btn_action:hover {
    border-color: #666;
    background: #e0e0e0;
}
.bag_btn_action.disabled {
    opacity: 0.6;
    cursor: not-allowed;
    background: #eee;
}

/* === 5. 主内容区 (左列表 右详情) === */
.bag_main_area {
    display: flex;
    flex: 1;
    overflow: hidden; /* 防止溢出 */
}

/* 左侧网格列表 */
.bag_grid_scroll {
    flex: 7; /* 占据较大比例 */
    overflow-y: auto;
    padding: 15px;
    background: #fafafa;
    border-right: 1px solid #eee;
}

.bag_grid_content {
    display: grid;
    /* 自适应列宽，每个格子稍微加大以容纳大字 */
    grid-template-columns: repeat(auto-fill, minmax(85px, 1fr));
    gap: 12px;
}

.bag_grid_item {
    aspect-ratio: 1; /* 正方形 */
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 6px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    position: relative;
    transition: transform 0.1s, box-shadow 0.1s;
    padding: 5px;
}

.bag_grid_item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    z-index: 2;
}

.bag_grid_item.selected {
    border: 2px solid #a94442;
    background-color: #fff5f5;
}

.bag_check_mark {
    display: none;
    position: absolute;
    top: 2px;
    right: 2px;
    width: 20px;
    height: 20px;
    background: #a94442;
    color: #fff;
    font-size: 14px;
    text-align: center;
    line-height: 20px;
    border-radius: 3px;
}
.bag_grid_item.selected .bag_check_mark { display: block; }

.bag_grid_icon {
    font-size: 36px; /* 原32px -> 36px */
    margin-bottom: 2px;
}

.bag_grid_name {
    font-size: 18px; /* 【修改重点】 原13px -> 18px */
    font-weight: bold; /* 加粗让字体更清晰 */
    width: 95%;
    text-align: center;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis; /* 超出显示省略号 */
    line-height: 1.2;
}

.bag_item_count {
    position: absolute;
    bottom: 4px;
    right: 4px;
    background: rgba(0,0,0,0.7); /* 加深背景增加对比度 */
    color: #fff;
    font-size: 12px; /* 原10px -> 12px */
    font-weight: bold;
    padding: 1px 5px;
    border-radius: 4px;
}

/* 右侧详情 */
.bag_detail_panel {
    flex: 3;
    min-width: 240px; /* 加宽详情栏 */
    background: #fff;
    padding: 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.bag_detail_header {
    font-size: 22px; /* 加大标题 */
    font-weight: bold;
    border-bottom: 2px solid #333;
    padding-bottom: 10px;
    margin-bottom: 10px;
}
.bag_detail_type {
    color: #888;
    margin-bottom: 15px;
    font-size: 16px; /* 加大类型文字 */
}
.bag_detail_stats {
    font-size: 20px; /* 加大属性文字 */
    line-height: 1.6;
    margin-bottom: 15px;
}
.bag_detail_desc {
    color: #666;
    font-style: italic;
    margin-bottom: 22px;
    line-height: 1.5;
    font-size: 16px; /* 加大描述文字 */
    background: #f9f9f9;
    padding: 12px;
    border-radius: 4px;
}
.bag_detail_actions {
    margin-top: auto;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: flex-end;
}

/* --- 新增：间隔与消耗品栏样式 --- */

/* 1. 间隔 (垂直竖线 + 留白) */
.bag_equip_spacer {
    width: 2px;
    height: 60px; /* 跟装备栏高度差不多 */
    background-color: #eee;
    margin: 0 15px; /* 左右留白，制造“隔开一格”的效果 */
    align-self: center;
}

/* 顶部装备栏 (基础样式) */
.bag_equip_slot {
    width: 50px;
    height: 50px;
    border: 2px dashed #ccc; /* 默认：无物品，虚线 */
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #fff; /* 默认白底 */
    transition: all 0.2s;
    position: relative;
    cursor: pointer;
}

/* 常规装备格：有物品时 */
.bag_equip_slot.active {
    border-style: solid;
    background: #fffbf0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* === 消耗品格子特殊样式 === */

/* 1. 消耗品格基础：绿色虚线框，淡绿背景 (表示这是放药的) */
.bag_equip_slot.slot_consumable {
    border-color: #a5d6a7;
    background-color: #f1f8e9;
    border-style: dashed;
}

/* 2. 消耗品格：有物品时 (has_item) */
.bag_equip_slot.slot_consumable.has_item {
    border-style: solid; /* 实线 */
    border-color: #66bb6a; /* 深一点的绿框 */
    background-color: #e8f5e9; /* 稍微深一点的背景 */
    box-shadow: 0 2px 4px rgba(0,128,0,0.15);
}

/* 悬停效果 */
.bag_equip_slot.slot_consumable:hover {
    box-shadow: 0 0 8px rgba(76, 175, 80, 0.3);
}

/* 消耗品标签颜色 */
.bag_equip_wrapper .bag_equip_label {
    font-size: 15px;
    color: #666;
}
/* 消耗品栏标签颜色 (无论有无物品，稍微带点绿) */
.bag_equip_wrapper:hover .bag_equip_slot.slot_consumable + .bag_equip_label {
    color: #558b2f;
}
/* 3. 详情页按钮 (危险操作/取消携带) */
.bag_btn_danger {
    padding: 8px 16px;
    border: 1px solid #d32f2f;
    background: #fff;
    color: #d32f2f;
    cursor: pointer;
    font-size: 14px;
    border-radius: 4px;
    transition: all 0.2s;
    font-family: inherit;
}
.bag_btn_danger:hover {
    background: #d32f2f;
    color: #fff;
}

/* --- 核心修改：未激活状态下的图标样式 --- */
.bag_equip_slot img {
    width: 80%;
    height: 80%;
    object-fit: contain;
    /* 默认：未装备时置灰，并增加透明度 */
    filter: grayscale(100%);
    opacity: 0.4;
    transition: all 0.3s ease;
}

/* --- 当父容器有 active 或 has_item 类时，恢复彩色 --- */
.bag_equip_slot.active img,
.bag_equip_slot.has_item img {
    filter: grayscale(0%);
    opacity: 1;
}

/* 也可以给虚线框增加一点视觉引导 */
.bag_equip_slot:not(.active) {
    border-color: #ddd;
    background-color: #f5f5f5;
}
/* 默认：未装备状态 (没有 .active 类) */
.bag_equip_slot .bag_equip_icon {
    filter: grayscale(100%); /* 强制变灰 */
    opacity: 0.3;            /* 降低透明度，让它看起来更像占位符 */
    transition: all 0.3s;    /* 切换时平滑一点 */
    display: flex;
    justify-content: center;
    align-items: center;
}

/* 激活状态：装备后 (有 .active 或 .has_item 类) */
.bag_equip_slot.active .bag_equip_icon,
.bag_equip_slot.has_item .bag_equip_icon {
    filter: grayscale(0%);   /* 恢复彩色 */
    opacity: 1;              /* 恢复亮度 */
}

/* 针对 Emoji 的特殊处理 (有些浏览器 Emoji 不受 grayscale 影响) */
.bag_equip_slot:not(.active):not(.has_item) .bag_equip_icon {
    /* 如果 grayscale 对 Emoji 无效，可以尝试降低亮度或使用特定的蒙版 */
    filter: grayscale(100%) brightness(0.7);
}